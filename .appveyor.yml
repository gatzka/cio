# Specify version format
version: "{build}"

image:
  - Visual Studio 2017

configuration:
  - Debug
  - Release

platform:
  - x86
  - x64

environment:
  matrix:
    - GENERATOR: "Visual Studio 15 2017"
      os: Visual Studio 2017


# scripts that are called at very beginning, before repo cloning
init:
  - cmd: cmake --help
  - cmd: msbuild /version

clone_folder: C:\projects\cio

# branches to build
branches:
  except:
    - gh-pages
    - /^feature.*$/
    - /^fix.*$/

# scripts that run after cloning repository
install:
  - cmd: git submodule update --init --recursive

# scripts to run before build
before_build:
  - cmd: cd C:\projects\cio
  - cmd: md build
  - cmd: cd build
#  - cmd: if "%platform%"=="Win32" cmake -G "%GENERATOR%" -DCMAKE_BUILD_TYPE=%configuration% -DBUILD_SHARED_LIBS=ON -DBOOST_ROOT="%BOOST_ROOT%" ..
#  - cmd: if "%platform%"=="x64" cmake -G "%GENERATOR% Win64" -DCMAKE_BUILD_TYPE=%configuration% -DBUILD_SHARED_LIBS=ON -DBOOST_ROOT="%BOOST_ROOT%" ..

# build:
  project: C:\projects\mfast\build\mfast.sln

test_script:
  - cmd: ctest -C %configuration% -VV
